<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Actions &mdash; Plone Community Managed Developer Manual v1.0 documentation</title>
    <link rel="stylesheet" href="../_static/plone.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Plone Community Managed Developer Manual v1.0 documentation" href="../index.html" />
    <link rel="up" title="Functionality and features" href="index.html" />
    <link rel="next" title="Expressions" href="expressions.html" />
    <link rel="prev" title="Functionality and features" href="index.html" />
<script language="javascript">
//<![CDATA[

Documentation.addTranslations({"locale": "fr", "plural_expr": "(n > 1)", "messages": {"See the definition": "Voir la d\u00e9finition"}});

// See http://disqus.disqus.com/general_integration_help/
var disqus_developer = 1;
if (document.location.protocol == 'http:') {
    disqus_developer = 0;
}

// Some HTML/CSS transforms we can't do in pure CSS (waiting for CSS3 support)
$(document).ready(function () {

    // Style of .. verisonmodified:: , .. versionadded:: ...
    $('p:has(span.versionmodified)').addClass('p-versionmodified');

    // Style of the TOC tree
    $('ul:has(li.toctree-l1)').addClass('toctree');

    // Decorate links to other sites
    $('a[class~=external]').attr('target', '_blank');

    // Glossary terms
    $('em.xref').attr('title', _('See the definition'));

    // We need to have all <pre> in a <div class="highlight"> to mimic pygments
    // to work around a pygments (?) bug
    var suffixes = {cfg: null, python:null};
    for (var suffix in suffixes) {
        var pattern = 'div.highlight-' + suffix + ' > pre';
        $(pattern).wrap('<div class="highlight" />');
    }
    return true;
});
//]]>
</script>

  </head>
  <body>
<!--[if lte IE 6]>
<style type="text/css">
#ie6msg{border:3px solid #090; margin:8px 0; background:#cfc; color:#000;}
#ie6msg h4{margin:8px; padding:0;}
#ie6msg p{margin:8px; padding:0;}
#ie6msg p a.getie8{font-weight:bold; color:#006;}
#ie6msg p a.ie6expl{font-weight:normal; color:#006;}
</style>
<div id="ie6msg">
<h4>Did you know that your browser is out of date?</h4>
<p>If the layout of this site seems ugly, that's because you're actually using
an outdated browser. And we wont put any effort to provide a nice layout to IE6
users.</p>
<p>To get the best possible experience using our website we recommend that you
upgrade your browser to a newer version. The current version
is <a class="getie8"
href="http://upgradeie.s3.amazonaws.com/eng/index.html">Internet Explorer
8</a>. The upgrade is free. If you're using a PC at work you should contact your
IT administrator.</p>
<p>If you want to you may also try some other popular Internet browsers
like <a class="ie6expl"
href="http://getfirefox.com">Firefox</a>, <a class="ie6expl"
href="http://www.google.com/chrome">Chrome</a>, <a class="ie6expl"
href="http://www.opera.com">Opera</a>, or <a class="ie6expl"
href="http://www.apple.com/safari/download/">Safari</a></p>
</div>
<![endif]-->

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="expressions.html" title="Expressions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Functionality and features"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Plone Community Managed Developer Manual v1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Functionality and features</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="sphinx-content">
    <div class="section" id="actions">
<h1>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h1>
<div class="admonition-description admonition ">
<p class="first admonition-title">Description</p>
<p class="last">Creating and using portal_actions mechanism</p>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id1">Introduction</a></li>
<li><a class="reference internal" href="#creating-actions-through-the-web" id="id2">Creating actions through-the-web</a><ul>
<li><a class="reference internal" href="#exporting-and-importing-all-portal-actions" id="id3">Exporting and importing all portal_actions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-actions-xml-by-hand" id="id4">Creating actions.xml by hand</a><ul>
<li><a class="reference internal" href="#reordering-actions-in-actions-xml" id="id5">Reordering actions in actions.xml</a></li>
</ul>
</li>
<li><a class="reference internal" href="#action-urls" id="id6">Action URLs</a></li>
<li><a class="reference internal" href="#default-action" id="id7">Default action</a></li>
<li><a class="reference internal" href="#content-type-specific-actions" id="id8">Content-type specific actions</a></li>
<li><a class="reference internal" href="#toggling-action-visibility-programmatically" id="id9">Toggling action visibility programmatically</a></li>
<li><a class="reference internal" href="#visibility-expressions" id="id10">Visibility expressions</a><ul>
<li><a class="reference internal" href="#condition-examples" id="id11">Condition examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-actions-in-views-and-viewlets" id="id12">Using actions in views and viewlets</a></li>
<li><a class="reference internal" href="#tabs-sections" id="id13">Tabs (sections)</a></li>
<li><a class="reference internal" href="#different-tabs-per-section-folder" id="id14">Different tabs per section/folder</a></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Plone has concept of actions which refer the end user functionality associated with site
or content objects:</p>
<ul class="simple">
<li>View, edit, sharing etc. are actions</li>
<li>Sitemap is action</li>
<li>Contact form is action</li>
<li>Cut, copy, paste are actions</li>
<li>Logged in menu is populated by actions</li>
</ul>
<p>Actions are managed by</p>
<ul class="simple">
<li>portal_actions for generic actions</li>
<li>portal_types for view, edit etc. actions and object default action... all actions
which are tied to a particular content type and may vary by type</li>
</ul>
</div>
<div class="section" id="creating-actions-through-the-web">
<h2><a class="toc-backref" href="#id2">Creating actions through-the-web</a><a class="headerlink" href="#creating-actions-through-the-web" title="Permalink to this headline">¶</a></h2>
<p>Visit portal_actions in ZMI.</p>
<div class="section" id="exporting-and-importing-all-portal-actions">
<h3><a class="toc-backref" href="#id3">Exporting and importing all portal_actions</a><a class="headerlink" href="#exporting-and-importing-all-portal-actions" title="Permalink to this headline">¶</a></h3>
<p>You can transfer action configuration from a Plone site to another using GenericSetup export/import XML.
You can also do this to generate XML from which you can cut out snippets for creating
actions.xml by hand.</p>
<ul class="simple">
<li>Go to portal_setup</li>
<li>Choose Export</li>
<li>Choose actions</li>
<li>Choose &quot;Export selected steps&quot; button at the end of the page</li>
<li>...and so on</li>
</ul>
</div>
</div>
<div class="section" id="creating-actions-xml-by-hand">
<h2><a class="toc-backref" href="#id4">Creating actions.xml by hand</a><a class="headerlink" href="#creating-actions-xml-by-hand" title="Permalink to this headline">¶</a></h2>
<p>Usually all actions are rewritten by site policy product using portal_actions import/export.
Actions are in GenericSetup profile file <em>default/profiles/actions.xml</em>.</p>
<ol class="arabic simple">
<li>actions.xml is exported from the development instance using portal_setup</li>
<li>actions.xml is made part of the site policy product</li>
</ol>
<p>Alternatively, if you are developing add-on product, you can add actions one-by-one by
manually creating entries in actions.xml.</p>
<p>Example how to add an action to object actions:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;portal_actions&quot;</span> <span class="na">meta_type=</span><span class="s">&quot;Plone Actions Tool&quot;</span>
   <span class="na">xmlns:i18n=</span><span class="s">&quot;http://xml.zope.org/namespaces/i18n&quot;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;document_actions&quot;</span> <span class="na">meta_type=</span><span class="s">&quot;CMF Action Category&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;sendto&quot;</span> <span class="na">meta_type=</span><span class="s">&quot;CMF Action&quot;</span> <span class="na">i18n:domain=</span><span class="s">&quot;plone&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;title&quot;</span> <span class="na">i18n:translate=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Send this<span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">i18n:translate=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;url_expr&quot;</span><span class="nt">&gt;</span>string:$object_url/sendto_form<span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;icon_expr&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;available_expr&quot;</span><span class="nt">&gt;</span>object/@@shareable<span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;permissions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">value=</span><span class="s">&quot;Allow sendto&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;visible&quot;</span><span class="nt">&gt;</span>True<span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/object&gt;</span>
<span class="nt">&lt;/object&gt;</span>
</pre></div>
</div>
<p>Example how to add actions to user menu, which is
visible in the top right corner for logged in users (Plone 4):</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;portal_actions&quot;</span> <span class="na">meta_type=</span><span class="s">&quot;Plone Actions Tool&quot;</span>
   <span class="na">xmlns:i18n=</span><span class="s">&quot;http://xml.zope.org/namespaces/i18n&quot;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;user&quot;</span> <span class="na">meta_type=</span><span class="s">&quot;CMF Action Category&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;ora_sync&quot;</span> <span class="na">meta_type=</span><span class="s">&quot;CMF Action&quot;</span> <span class="na">i18n:domain=</span><span class="s">&quot;plone&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;title&quot;</span> <span class="na">i18n:translate=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>ORA<span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">i18n:translate=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>ORA site synchronization status<span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;url_expr&quot;</span><span class="nt">&gt;</span>string:${portal_url}/@@syncall<span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;icon_expr&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;available_expr&quot;</span><span class="nt">&gt;&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;permissions&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;element</span> <span class="na">value=</span><span class="s">&quot;Manage portal&quot;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/property&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;visible&quot;</span><span class="nt">&gt;</span>True<span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;/object&gt;</span>
 <span class="nt">&lt;/object&gt;</span>
<span class="nt">&lt;/object&gt;</span>
</pre></div>
</div>
<div class="section" id="reordering-actions-in-actions-xml">
<h3><a class="toc-backref" href="#id5">Reordering actions in actions.xml</a><a class="headerlink" href="#reordering-actions-in-actions-xml" title="Permalink to this headline">¶</a></h3>
<p>Try using these attributes</p>
<ul class="simple">
<li>insert-after</li>
<li>insert-before</li>
</ul>
<p>They accept * and action name parameters.</p>
<p>Example:</p>
<div class="highlight-python"><pre>&lt;object name="sendto" meta_type="CMF Action" i18n:domain="plone" insert-before="*"&gt;</pre>
</div>
</div>
</div>
<div class="section" id="action-urls">
<h2><a class="toc-backref" href="#id6">Action URLs</a><a class="headerlink" href="#action-urls" title="Permalink to this headline">¶</a></h2>
<p>Actions are applied to objects by adding action name to url.</p>
<p>E.g.:</p>
<div class="highlight-python"><pre>http://localhost:8080/site/page/view</pre>
</div>
<p>for view action and:</p>
<div class="highlight-python"><pre>http://localhost:8080/site/page/edit</pre>
</div>
<p>for edit action.</p>
<p>Action can be also not related to document, like:</p>
<div class="highlight-python"><pre>http://localhost:8080/site/sitemap</pre>
</div>
</div>
<div class="section" id="default-action">
<h2><a class="toc-backref" href="#id7">Default action</a><a class="headerlink" href="#default-action" title="Permalink to this headline">¶</a></h2>
<p>Default action is executed when the content URL is opened without any
prefix.</p>
<p>Default action is defined in portal_types.</p>
<p>Default action can be dynamic - meaning that
site editor may set it from Display menu. For more information see
Dynamic Views.</p>
</div>
<div class="section" id="content-type-specific-actions">
<h2><a class="toc-backref" href="#id8">Content-type specific actions</a><a class="headerlink" href="#content-type-specific-actions" title="Permalink to this headline">¶</a></h2>
<p>Content-type specific actions can be registered in portal_types.
Actions are viewable and editable in Zope Management Interface under portal_types.
After editing actions,
content type XML can be  exported and placed to your content type add-on product.</p>
<p>GenericSetup example file for content type &quot;ProductCard&quot; which has a new tab added
next to view, edit, sharing, etc. File is located in profiles/default/types/ProductCard.xml.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;ProductCard&quot;</span>
   <span class="na">meta_type=</span><span class="s">&quot;Factory-based Type Information with dynamic views&quot;</span>
   <span class="na">i18n:domain=</span><span class="s">&quot;saariselka.app&quot;</span> <span class="na">xmlns:i18n=</span><span class="s">&quot;http://xml.zope.org/namespaces/i18n&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;title&quot;</span> <span class="na">i18n:translate=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>Tuotekortti<span class="nt">&lt;/property&gt;</span>
  ....
  <span class="nt">&lt;alias</span> <span class="na">from=</span><span class="s">&quot;(Default)&quot;</span> <span class="na">to=</span><span class="s">&quot;(dynamic view)&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;alias</span> <span class="na">from=</span><span class="s">&quot;edit&quot;</span> <span class="na">to=</span><span class="s">&quot;atct_edit&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;alias</span> <span class="na">from=</span><span class="s">&quot;sharing&quot;</span> <span class="na">to=</span><span class="s">&quot;@@sharing&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;alias</span> <span class="na">from=</span><span class="s">&quot;view&quot;</span> <span class="na">to=</span><span class="s">&quot;(selected layout)&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">title=</span><span class="s">&quot;View&quot;</span> <span class="na">action_id=</span><span class="s">&quot;view&quot;</span> <span class="na">category=</span><span class="s">&quot;object&quot;</span> <span class="na">condition_expr=</span><span class="s">&quot;&quot;</span>
    <span class="na">url_expr=</span><span class="s">&quot;string:${object_url}/&quot;</span> <span class="na">visible=</span><span class="s">&quot;True&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;permission</span> <span class="na">value=</span><span class="s">&quot;View&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">title=</span><span class="s">&quot;Edit&quot;</span> <span class="na">action_id=</span><span class="s">&quot;edit&quot;</span> <span class="na">category=</span><span class="s">&quot;object&quot;</span> <span class="na">condition_expr=</span><span class="s">&quot;&quot;</span>
    <span class="na">url_expr=</span><span class="s">&quot;string:${object_url}/edit&quot;</span> <span class="na">visible=</span><span class="s">&quot;True&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;permission</span> <span class="na">value=</span><span class="s">&quot;Modify portal content&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="c">&lt;!-- Custom action code goes here. We add a new tab with title &quot;Data&quot; and</span>
<span class="c">         uri @@productdata_view which is a registered BrowserView for the content type.</span>
<span class="c">    --&gt;</span>

 <span class="nt">&lt;action</span> <span class="na">title=</span><span class="s">&quot;Data&quot;</span> <span class="na">action_id=</span><span class="s">&quot;productdata_view&quot;</span> <span class="na">category=</span><span class="s">&quot;object&quot;</span> <span class="na">condition_expr=</span><span class="s">&quot;&quot;</span>
    <span class="na">url_expr=</span><span class="s">&quot;string:${object_url}/@@productdata_view&quot;</span> <span class="na">visible=</span><span class="s">&quot;True&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;permission</span> <span class="na">value=</span><span class="s">&quot;Modify portal content&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

<span class="nt">&lt;/object&gt;</span>
</pre></div>
</div>
<p>The corresponding BrowserView is registered as any other view in <em>browse/configure.zcml</em>:</p>
<div class="highlight-python"><pre>.. code-block:: xml</pre>
</div>
<blockquote>
<dl class="docutils">
<dt>&lt;browser:page</dt>
<dd>for=&quot;*&quot;
name=&quot;productdata_view&quot;
class=&quot;.productdataview.ProductDataView&quot;
template=&quot;productdataview.pt&quot;
allowed_attributes=&quot;renderData&quot;
permission=&quot;zope2.View&quot;
/&gt;</dd>
</dl>
</blockquote>
</div>
<div class="section" id="toggling-action-visibility-programmatically">
<h2><a class="toc-backref" href="#id9">Toggling action visibility programmatically</a><a class="headerlink" href="#toggling-action-visibility-programmatically" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This applies only for Plone 2.5. You should use actions.xml instead.</p>
</div>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">disable_actions</span><span class="p">(</span><span class="n">portal</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Remove unneeded Plone actions</span>

<span class="sd">    @param portal Plone instance</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># getActionObject takes parameter category/action id</span>
    <span class="c"># For ids and categories please refer to portal_actins in ZMI</span>
    <span class="n">actionInformation</span> <span class="o">=</span> <span class="n">portal</span><span class="o">.</span><span class="n">portal_actions</span><span class="o">.</span><span class="n">getActionObject</span><span class="p">(</span><span class="s">&quot;document_actions/rss&quot;</span><span class="p">)</span>

    <span class="c"># See ActionInformation.py / ActionInformation for available edits</span>
    <span class="n">actionInformation</span><span class="o">.</span><span class="n">edit</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="visibility-expressions">
<h2><a class="toc-backref" href="#id10">Visibility expressions</a><a class="headerlink" href="#visibility-expressions" title="Permalink to this headline">¶</a></h2>
<p>In portal_actions expression is used to determine whether an action is visible
on a particular page.</p>
<p>Expression is &quot;expression&quot; field in actions.xml or &quot;Expression&quot; field in
portal_actions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This check is just a visibility check. Users can still
try to type the action by typing the URL manually. You need
to do the permission level security check on the view providing the action.</p>
</div>
<p>For more information see <a class="reference internal" href="expressions.html"><em>expressions</em></a>.</p>
<div class="section" id="condition-examples">
<h3><a class="toc-backref" href="#id11">Condition examples</a><a class="headerlink" href="#condition-examples" title="Permalink to this headline">¶</a></h3>
<p>See in <a class="reference internal" href="expressions.html"><em>expressions</em></a>.</p>
</div>
</div>
<div class="section" id="using-actions-in-views-and-viewlets">
<h2><a class="toc-backref" href="#id12">Using actions in views and viewlets</a><a class="headerlink" href="#using-actions-in-views-and-viewlets" title="Permalink to this headline">¶</a></h2>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">context_state</span> <span class="o">=</span> <span class="n">getMultiAdapter</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">),</span>
                            <span class="n">name</span><span class="o">=</span><span class="s">u&#39;plone_context_state&#39;</span><span class="p">)</span>

<span class="c"># First argument is action catagory,</span>
<span class="c"># we have custom &quot;mobile_actions&quot;</span>
<span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">context_state</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;mobile_actions&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="tabs-sections">
<h2><a class="toc-backref" href="#id13">Tabs (sections)</a><a class="headerlink" href="#tabs-sections" title="Permalink to this headline">¶</a></h2>
<p>Tabs are special actions</p>
<ul class="simple">
<li>Some of tabs are automatically generated from root level content items</li>
<li>Some of tabs are manually added to portal_actions.portal_tabs</li>
</ul>
<p>By default, they are shown as the top vertical navigation of Plone site.</p>
<p>Example how to generate tabs list:</p>
<div class="highlight-python"><pre>   def getSections(self):
       """

       @return: tuple (selectedTabs, currentSelectedTab)
       """

       context_state = getMultiAdapter((self.context, self.request),
                                       name=u'plone_context_state')
       actions = context_state.actions()


       # Get CatalogNavigationTabs instance
       portal_tabs_view = getMultiAdapter((self.context, self.request),
                                          name='portal_tabs_view')

       # Action parameter is "portal_tabs" by default, but can be other
       portal_tabs = portal_tabs_view.topLevelTabs(actions=actions)

       selectedTabs = self.context.restrictedTraverse('selectedTabs')

       selected_tabs = selectedTabs('index_html',
                                         self.context,
                                         portal_tabs)

       selected_portal_tab = selected_tabs['portal']

       return (portal_tabs, selected_portal_tab)

Custom action listings
----------------------

Example::

       import Acquisition
       from zope.component import getMultiAdapter

       class Sections(base.Sections):
           """
           """

           def update(self):
               base.Sections.update(self)

               context = Acquisition.aq_inner(self.context)
               # IContextState view provides shortcut to get different action listings
               context_state = getMultiAdapter((context, self.request), name=u'plone_context_state')
               all_actions = context_state.keyed_actions() # id -&gt; action mappings
               mobile_site_actions = all_actions["mobile_site_actions"].values()
               self.portal_tabs = mobile_site_actions</pre>
</div>
</div>
<div class="section" id="different-tabs-per-section-folder">
<h2><a class="toc-backref" href="#id14">Different tabs per section/folder</a><a class="headerlink" href="#different-tabs-per-section-folder" title="Permalink to this headline">¶</a></h2>
<p>You might want to have different actions for different site sections or folders.</p>
<ul class="simple">
<li><a class="reference external" href="http://plone.293351.n2.nabble.com/Custom-portal-tabs-per-subsection-tp5747768p5747768.html">http://plone.293351.n2.nabble.com/Custom-portal-tabs-per-subsection-tp5747768p5747768.html</a></li>
</ul>
</div>
</div>

  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<p class="logo"><a href="../index.html"><img src="../_static/plone-icon-64.png" />
</a></p>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Actions</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#creating-actions-through-the-web">Creating actions through-the-web</a><ul>
<li><a class="reference internal" href="#exporting-and-importing-all-portal-actions">Exporting and importing all portal_actions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-actions-xml-by-hand">Creating actions.xml by hand</a><ul>
<li><a class="reference internal" href="#reordering-actions-in-actions-xml">Reordering actions in actions.xml</a></li>
</ul>
</li>
<li><a class="reference internal" href="#action-urls">Action URLs</a></li>
<li><a class="reference internal" href="#default-action">Default action</a></li>
<li><a class="reference internal" href="#content-type-specific-actions">Content-type specific actions</a></li>
<li><a class="reference internal" href="#toggling-action-visibility-programmatically">Toggling action visibility programmatically</a></li>
<li><a class="reference internal" href="#visibility-expressions">Visibility expressions</a><ul>
<li><a class="reference internal" href="#condition-examples">Condition examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-actions-in-views-and-viewlets">Using actions in views and viewlets</a></li>
<li><a class="reference internal" href="#tabs-sections">Tabs (sections)</a></li>
<li><a class="reference internal" href="#different-tabs-per-section-folder">Different tabs per section/folder</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Functionality and features</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="expressions.html"
                        title="next chapter">Expressions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/functionality/actions.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="expressions.html" title="Expressions"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Functionality and features"
             >previous</a> |</li>
        <li><a href="../index.html">Plone Community Managed Developer Manual v1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Functionality and features</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010 mFabrik Research Oy and Plone community contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>


  </body>
</html>