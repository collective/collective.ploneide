<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Import and export &mdash; Plone Community Managed Developer Manual v1.0 documentation</title>
    <link rel="stylesheet" href="../_static/plone.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Plone Community Managed Developer Manual v1.0 documentation" href="../index.html" />
    <link rel="up" title="Content management" href="index.html" />
    <link rel="next" title="Eventish content types" href="events.html" />
    <link rel="prev" title="History and versioning" href="history.html" />
<script language="javascript">
//<![CDATA[

Documentation.addTranslations({"locale": "fr", "plural_expr": "(n > 1)", "messages": {"See the definition": "Voir la d\u00e9finition"}});

// See http://disqus.disqus.com/general_integration_help/
var disqus_developer = 1;
if (document.location.protocol == 'http:') {
    disqus_developer = 0;
}

// Some HTML/CSS transforms we can't do in pure CSS (waiting for CSS3 support)
$(document).ready(function () {

    // Style of .. verisonmodified:: , .. versionadded:: ...
    $('p:has(span.versionmodified)').addClass('p-versionmodified');

    // Style of the TOC tree
    $('ul:has(li.toctree-l1)').addClass('toctree');

    // Decorate links to other sites
    $('a[class~=external]').attr('target', '_blank');

    // Glossary terms
    $('em.xref').attr('title', _('See the definition'));

    // We need to have all <pre> in a <div class="highlight"> to mimic pygments
    // to work around a pygments (?) bug
    var suffixes = {cfg: null, python:null};
    for (var suffix in suffixes) {
        var pattern = 'div.highlight-' + suffix + ' > pre';
        $(pattern).wrap('<div class="highlight" />');
    }
    return true;
});
//]]>
</script>

  </head>
  <body>
<!--[if lte IE 6]>
<style type="text/css">
#ie6msg{border:3px solid #090; margin:8px 0; background:#cfc; color:#000;}
#ie6msg h4{margin:8px; padding:0;}
#ie6msg p{margin:8px; padding:0;}
#ie6msg p a.getie8{font-weight:bold; color:#006;}
#ie6msg p a.ie6expl{font-weight:normal; color:#006;}
</style>
<div id="ie6msg">
<h4>Did you know that your browser is out of date?</h4>
<p>If the layout of this site seems ugly, that's because you're actually using
an outdated browser. And we wont put any effort to provide a nice layout to IE6
users.</p>
<p>To get the best possible experience using our website we recommend that you
upgrade your browser to a newer version. The current version
is <a class="getie8"
href="http://upgradeie.s3.amazonaws.com/eng/index.html">Internet Explorer
8</a>. The upgrade is free. If you're using a PC at work you should contact your
IT administrator.</p>
<p>If you want to you may also try some other popular Internet browsers
like <a class="ie6expl"
href="http://getfirefox.com">Firefox</a>, <a class="ie6expl"
href="http://www.google.com/chrome">Chrome</a>, <a class="ie6expl"
href="http://www.opera.com">Opera</a>, or <a class="ie6expl"
href="http://www.apple.com/safari/download/">Safari</a></p>
</div>
<![endif]-->

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="events.html" title="Eventish content types"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="history.html" title="History and versioning"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Plone Community Managed Developer Manual v1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Content management</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="sphinx-content">
    <div class="section" id="import-and-export">
<h1><a class="toc-backref" href="#id4">Import and export</a><a class="headerlink" href="#import-and-export" title="Permalink to this headline">¶</a></h1>
<div class="admonition-description admonition ">
<p class="first admonition-title">Description</p>
<p class="last">Importing and exporting content between Plone sites and other CMS sysstems</p>
</div>
<div class="contents topic" id="local">
<p class="topic-title first">local</p>
<ul class="simple">
<li><a class="reference internal" href="#import-and-export" id="id4">Import and export</a><ul>
<li><a class="reference internal" href="#introduction" id="id5">Introduction</a></li>
<li><a class="reference internal" href="#id1" id="id6">quintagroup.transmogrifier</a><ul>
<li><a class="reference internal" href="#exporting-single-folder-only" id="id7">Exporting single folder only</a><ul>
<li><a class="reference internal" href="#source-site" id="id8">Source site</a></li>
<li><a class="reference internal" href="#target-site" id="id9">Target site</a></li>
<li><a class="reference internal" href="#more-information" id="id10">More information</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#fast-content-import" id="id11">Fast content import</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id5">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Goal: you want to import and export content between Plone sites.</p>
<ul class="simple">
<li>If both sites have identical version and add-on product configuration you can use Zope Management Interface export/import</li>
<li>If they don't and you e.g. have different Plone version on source and target site, you need to use add-on product like <a class="reference external" href="http://projects.quintagroup.com/products/wiki/quintagroup.transmogrifier">quintagroup.transmogrifier</a></li>
</ul>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id6">quintagroup.transmogrifier</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://projects.quintagroup.com/products/wiki/quintagroup.transmogrifier">quintagroup.transmogrifier</a> is an add-on product which provides Plone adminstrator user interface for
exporting and importing content.</p>
<p>Internally, it uses <a class="reference external" href="http://pypi.python.org/pypi/collective.transmogrifier">collective.transmogrifier</a> package which itself does not provide any kind of user interface.</p>
<p><a class="reference external" href="http://pypi.python.org/pypi/collective.transmogrifier">Transmogrifier</a> is a tool which serializes and deserializes content based o
n pipelines. Pipelines are written in .ini-like plain text file based file format and they consists
of sections.
Blueprints are self-contained reusable components which can be recycled between different content migration pocesses.
Section is based on a blueprint and defines some configurable parameters for this blueprint.</p>
<div class="section" id="exporting-single-folder-only">
<h3><a class="toc-backref" href="#id7">Exporting single folder only</a><a class="headerlink" href="#exporting-single-folder-only" title="Permalink to this headline">¶</a></h3>
<p>Here is explained how to export and import <a class="reference external" href="http://plone.org">Plone CMS</a>
folders between different Plonen versions, or
different CMS systems, using  XML based content marshalling and
<a class="reference external" href="http://projects.quintagroup.com/products/wiki/quintagroup.transmogrifier">quintagroup.transmogrifier</a>.</p>
<p>This overcomes some problems with Zope management based export/import which uses <a class="reference external" href="http://docs.python.org/library/pickle.html">Python pickles</a> and thus needs identical codebase on the source
and target site. Exporting and importing between Plone 3 and Plone 4 is possible.</p>
<p>You can limit export to cover source content to with arbitary <a class="reference internal" href="../searching_and_indexing/query.html"><em>portal_catalog</em></a> conditions.
If you limit source content by path you can effectively export single folder only.</p>
<p>The recipe described here assumes the exported and imported site have the same path for the folder.
Manually rename or move the folder on source or target to change its location.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The instructions here requires quintagroup.transmogrify version 0.4 or later.</p>
</div>
<div class="section" id="source-site">
<h4><a class="toc-backref" href="#id8">Source site</a><a class="headerlink" href="#source-site" title="Permalink to this headline">¶</a></h4>
<p>Execute these actions on the source Plone site.</p>
<p>Install <tt class="docutils literal"><span class="pre">quintagroup.transmogrifier</span></tt> via buildout and Plone add-on control panel.</p>
<p>Go to <em>Site setup</em> &gt; <em>Content migration</em>.</p>
<p>Edit export settings. Remove unnecessary pipeline entries by looking the example below. Add a new <tt class="docutils literal"><span class="pre">catalogsource</span></tt> blueprint.
The <tt class="docutils literal"><span class="pre">exclude-contained</span></tt> option makes sure we do not export unnecessary items from the parent folders:</p>
<div class="highlight-python"><pre>[transmogrifier]
pipeline =
    catalogsource
    fileexporter
    marshaller
    datacorrector
    writer
    EXPORTING

[catalogsource]
blueprint = quintagroup.transmogrifier.catalogsource
path = query= /isleofback/ohjeet
exclude-contained = true</pre>
</div>
<p>Also we need to include some field-level exluding bits for the folders, because the target site does not necessary
have the same content types available as the source site and this may prevent
setting up folderish content settings:</p>
<div class="highlight-python"><pre>[marshaller]
blueprint = quintagroup.transmogrifier.marshaller
exclude =
  immediatelyAddableTypes
  locallyAllowedTypes</pre>
</div>
<p>You might want to remove other, unneeded blueprints from the export <tt class="docutils literal"><span class="pre">pipeline</span></tt>.
For example, <tt class="docutils literal"><span class="pre">portletexporter</span></tt> may cause problems if the source and target site
do not have the same portlet code.</p>
<p>Go to <em>Zope Management Interface</em> &gt; <em>portal_setup</em> &gt; <em>Export</em> tab. Check Content (transmogrifier) step.
Press <em>Export Selected Steps</em> at the bottom of the page. Now a .tar.gz file will be downloaded.</p>
<p>During the export process <tt class="docutils literal"><span class="pre">instance.log</span></tt> file is updated with status info. You might want to follow
it in real-time from UNIX command line</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">tail -f var/log/instance.log</span>
</pre></div>
</div>
<p>In log you should see entries running like:</p>
<div class="highlight-python"><pre>2010-12-27 12:05:30 INFO EXPORTING _path=sisalto/ohjeet/yritys/yritysten-tuotetiedot/tuotekortti
2010-12-27 12:05:30 INFO EXPORTING
Pipeline processing time: 00:00:02
          94 items were generated in source sections
          94 went through full pipeline
           0 were discarded in some section</pre>
</div>
</div>
<div class="section" id="target-site">
<h4><a class="toc-backref" href="#id9">Target site</a><a class="headerlink" href="#target-site" title="Permalink to this headline">¶</a></h4>
<p>Execute these actions on the target Plone site.</p>
<p>Install <tt class="docutils literal"><span class="pre">quintagroup.transmogrifier</span></tt> via buildout and Plone add-on control panel.</p>
<p>Open target site <tt class="docutils literal"><span class="pre">instance.log</span></tt> file for monitoring the import process</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">tail -f var/log/instance.log</span>
</pre></div>
</div>
<p>Go to <em>Zope Management Interface</em> &gt; <em>portal_setup</em> &gt; <em>Import</em> tab.</p>
<p>Choose downloaded <tt class="docutils literal"><span class="pre">setup_toolxxx.tar.gz</span></tt> file at the bottom of the page,
for <em>Import uploaded tarball</em> input.</p>
<p>Run import and monitoring log file for possible errors. Note that the import
completes even if the target site would not able to process incoming content.
If there is a serious problem the import seems to complete succesfully,
but no content is created.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently export/import is not perfect. For example, ZMI content type icons  are currently
lost in the process. It is recommended to do a test run on a staging server
before doing this process on a production server.
Also, the item order in the folder is being lost.</p>
</div>
</div>
<div class="section" id="more-information">
<h4><a class="toc-backref" href="#id10">More information</a><a class="headerlink" href="#more-information" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><a class="reference internal" href="../searching_and_indexing/query.html"><em>How to perform portal_catalog queries</em></a></li>
<li><a class="reference external" href="http://webteam.medsci.ox.ac.uk/integrators-developers/transmogrifier-i-want-to-.../">http://webteam.medsci.ox.ac.uk/integrators-developers/transmogrifier-i-want-to-.../</a></li>
<li><a class="reference external" href="https://svn.plone.org/svn/collective/quintagroup.transmogrifier/trunk/quintagroup/transmogrifier/catalogsource.py">https://svn.plone.org/svn/collective/quintagroup.transmogrifier/trunk/quintagroup/transmogrifier/catalogsource.py</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="fast-content-import">
<h2><a class="toc-backref" href="#id11">Fast content import</a><a class="headerlink" href="#fast-content-import" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>See <a class="reference external" href="http://blog.redturtle.it/redturtle-blog/fast-content-import">this blog post</a></li>
</ul>
</div>
</div>

  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<p class="logo"><a href="../index.html"><img src="../_static/plone-icon-64.png" />
</a></p>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Import and export</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#id1">quintagroup.transmogrifier</a><ul>
<li><a class="reference internal" href="#exporting-single-folder-only">Exporting single folder only</a><ul>
<li><a class="reference internal" href="#source-site">Source site</a></li>
<li><a class="reference internal" href="#target-site">Target site</a></li>
<li><a class="reference internal" href="#more-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#fast-content-import">Fast content import</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="history.html"
                        title="previous chapter">History and versioning</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="events.html"
                        title="next chapter">Eventish content types</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/content/importexport.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="events.html" title="Eventish content types"
             >next</a> |</li>
        <li class="right" >
          <a href="history.html" title="History and versioning"
             >previous</a> |</li>
        <li><a href="../index.html">Plone Community Managed Developer Manual v1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Content management</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010 mFabrik Research Oy and Plone community contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>


  </body>
</html>