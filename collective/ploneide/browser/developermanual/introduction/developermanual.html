<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>How to upload Plone community developer documentation to Plone CMS &mdash; Plone Community Managed Developer Manual v1.0 documentation</title>
    <link rel="stylesheet" href="../_static/plone.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Plone Community Managed Developer Manual v1.0 documentation" href="../index.html" />
    <link rel="up" title="Introduction" href="index.html" />
    <link rel="next" title="Tutorials" href="../tutorials/index.html" />
    <link rel="prev" title="Writing and updating this document" href="writing.html" />
<script language="javascript">
//<![CDATA[

Documentation.addTranslations({"locale": "fr", "plural_expr": "(n > 1)", "messages": {"See the definition": "Voir la d\u00e9finition"}});

// See http://disqus.disqus.com/general_integration_help/
var disqus_developer = 1;
if (document.location.protocol == 'http:') {
    disqus_developer = 0;
}

// Some HTML/CSS transforms we can't do in pure CSS (waiting for CSS3 support)
$(document).ready(function () {

    // Style of .. verisonmodified:: , .. versionadded:: ...
    $('p:has(span.versionmodified)').addClass('p-versionmodified');

    // Style of the TOC tree
    $('ul:has(li.toctree-l1)').addClass('toctree');

    // Decorate links to other sites
    $('a[class~=external]').attr('target', '_blank');

    // Glossary terms
    $('em.xref').attr('title', _('See the definition'));

    // We need to have all <pre> in a <div class="highlight"> to mimic pygments
    // to work around a pygments (?) bug
    var suffixes = {cfg: null, python:null};
    for (var suffix in suffixes) {
        var pattern = 'div.highlight-' + suffix + ' > pre';
        $(pattern).wrap('<div class="highlight" />');
    }
    return true;
});
//]]>
</script>

  </head>
  <body>
<!--[if lte IE 6]>
<style type="text/css">
#ie6msg{border:3px solid #090; margin:8px 0; background:#cfc; color:#000;}
#ie6msg h4{margin:8px; padding:0;}
#ie6msg p{margin:8px; padding:0;}
#ie6msg p a.getie8{font-weight:bold; color:#006;}
#ie6msg p a.ie6expl{font-weight:normal; color:#006;}
</style>
<div id="ie6msg">
<h4>Did you know that your browser is out of date?</h4>
<p>If the layout of this site seems ugly, that's because you're actually using
an outdated browser. And we wont put any effort to provide a nice layout to IE6
users.</p>
<p>To get the best possible experience using our website we recommend that you
upgrade your browser to a newer version. The current version
is <a class="getie8"
href="http://upgradeie.s3.amazonaws.com/eng/index.html">Internet Explorer
8</a>. The upgrade is free. If you're using a PC at work you should contact your
IT administrator.</p>
<p>If you want to you may also try some other popular Internet browsers
like <a class="ie6expl"
href="http://getfirefox.com">Firefox</a>, <a class="ie6expl"
href="http://www.google.com/chrome">Chrome</a>, <a class="ie6expl"
href="http://www.opera.com">Opera</a>, or <a class="ie6expl"
href="http://www.apple.com/safari/download/">Safari</a></p>
</div>
<![endif]-->

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../tutorials/index.html" title="Tutorials"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="writing.html" title="Writing and updating this document"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Plone Community Managed Developer Manual v1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Introduction</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="sphinx-content">
    <div class="section" id="how-to-upload-plone-community-developer-documentation-to-plone-cms">
<h1>How to upload Plone community developer documentation to Plone CMS<a class="headerlink" href="#how-to-upload-plone-community-developer-documentation-to-plone-cms" title="Permalink to this headline">¶</a></h1>
<div class="admonition-description admonition ">
<p class="first admonition-title">Description</p>
<p class="last">This document explains integrating Sphinx and Plone,
and uses the Plone Community Developer Manual and plone.org
site as an example.</p>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id3">Introduction</a></li>
<li><a class="reference internal" href="#collective-developermanual" id="id4">collective.developermanual</a></li>
<li><a class="reference internal" href="#setting-up-software-for-manual-compilation-and-upload" id="id5">Setting up software for manual compilation and upload</a></li>
<li><a class="reference internal" href="#building-static-html-with-sphinx" id="id6">Building static HTML with Sphinx</a></li>
<li><a class="reference internal" href="#uploading-documentation-to-a-site" id="id7">Uploading documentation to a site</a><ul>
<li><a class="reference internal" href="#setting-up-plone-site-for-uploading-sphinx-documentation" id="id8">Setting up Plone site for uploading Sphinx documentation</a></li>
<li><a class="reference internal" href="#compiling-html-manual" id="id9">Compiling HTML manual</a></li>
<li><a class="reference internal" href="#running-upload" id="id10">Running upload</a></li>
<li><a class="reference internal" href="#setting-up-css" id="id11">Setting up CSS</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id3">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This concerns only those who:</p>
<ul class="simple">
<li>wish to generate a HTML version of Plone Community Developer manual;</li>
<li>wish to upload Sphinx documentation to a Plone site.</li>
</ul>
</div>
<div class="section" id="collective-developermanual">
<h2><a class="toc-backref" href="#id4">collective.developermanual</a><a class="headerlink" href="#collective-developermanual" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/collective/collective.developermanual">collective.developermanual</a> is open-for-anyone-to-edit documentation for Plone developers in Sphinx format,
living in <a class="reference external" href="https://github.com/collective">Plone's collective Github version control system</a> (anyone can get commit access).</p>
<p><a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a> is a tool that makes it easy to create intelligent and beautiful documentation,
written by Georg Brandl and licensed under the BSD license.</p>
<p>collective.developermanual contains <a class="reference internal" href="../tutorials/buildout/index.html"><em>buildout.cfg recipes</em></a> to</p>
<ul class="simple">
<li>Install Sphinx</li>
<li>Compile manual to HTML</li>
<li>Upload manual to a Plone site (using the <tt class="docutils literal"><span class="pre">bin/toplone</span></tt> script and <tt class="docutils literal"><span class="pre">transmogrify</span></tt> source packages)</li>
</ul>
<p>Upload does not need any special support from the Plone site to accept Sphinx documentation
(besides installing <a class="reference external" href="http://plone.org/products/plonehelpcenter">Plone Help Center</a>, but the pipeline can be configured to use <em>Folders</em> and <em>Pages</em>
instead of <em>Reference Manual</em> content types).</p>
</div>
<div class="section" id="setting-up-software-for-manual-compilation-and-upload">
<h2><a class="toc-backref" href="#id5">Setting up software for manual compilation and upload</a><a class="headerlink" href="#setting-up-software-for-manual-compilation-and-upload" title="Permalink to this headline">¶</a></h2>
<p>First you need to install Git for your operating system to be able to checkout necessary source code:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">sudo apt-get install git-core # Debian-based Linux</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">sudo port install git-core # Mac, using MacPorts</span>
</pre></div>
</div>
<p>Run buildout to install Sphinx and the necessary packages for uploading. First step: bootstrap:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">python2.6 bootstrap.py</span>
<span class="go">bin/buildout</span>
</pre></div>
</div>
<p>This will always report an error, but the <tt class="docutils literal"><span class="pre">bin/</span></tt> folder is created and populated with the required scripts.
Now you need to checkout all the source code using the <em>Mr. Developer</em> tool:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">bin/develop co &quot;&quot;</span>
</pre></div>
</div>
<p>Run buildout again:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">bin/buildout</span>
</pre></div>
</div>
</div>
<div class="section" id="building-static-html-with-sphinx">
<h2><a class="toc-backref" href="#id6">Building static HTML with Sphinx</a><a class="headerlink" href="#building-static-html-with-sphinx" title="Permalink to this headline">¶</a></h2>
<p>This creates <tt class="docutils literal"><span class="pre">docs/html</span></tt> folder from the source documents in the <tt class="docutils literal"><span class="pre">source</span></tt> folder, by compiling all the <tt class="docutils literal"><span class="pre">collective.developermanual</span></tt> pages,
using <tt class="docutils literal"><span class="pre">sphinx-build</span></tt> command from buildout:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">make html</span>
</pre></div>
</div>
<p>If you want to build everything from the scratch, to see all warnings:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">make clean html</span>
</pre></div>
</div>
</div>
<div class="section" id="uploading-documentation-to-a-site">
<h2><a class="toc-backref" href="#id7">Uploading documentation to a site</a><a class="headerlink" href="#uploading-documentation-to-a-site" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">collective.developer</span></tt> manual contains a buildout
which defines a pipeline for <a class="reference external" href="http://pypi.python.org/pypi/collective.transmogrifier/">collective.transmogrify</a>
to upload the Sphinx-generated HTML files to  Plone site
as <a class="reference external" href="http://plone.org/products/plonehelpcenter">Plone Help Center</a> <em>Reference Manual</em> content.</p>
<p><tt class="docutils literal"><span class="pre">collective.transmogrify</span></tt> was originally developed to provide pipelines to import,
manipulate and export content. It allows you to use a plug-in architecture
to provide necessary steps, called <em>blueprints</em>, to pass content in a pipeline from one filter to another.
The idea is very similar to video and audio codec architectures.</p>
<p>Blueprints can be mix-and-matched using a <tt class="docutils literal"><span class="pre">pipeline.cfg</span></tt> configuration file.
<tt class="docutils literal"><span class="pre">collective.developermanual</span></tt> defines pipelines for crawling the generated Sphinx HTML files,
breaking down the HTML to fields (title, description, body) and then uploading it to a Plone
site using Zope's XML-RPC API and URL functions, like workflow transition, exposed by Plone.
As Zope provides the necessary XML-RPC facilities, no specific code for the uploader is
needed on the server running the Plone site.</p>
<div class="section" id="setting-up-plone-site-for-uploading-sphinx-documentation">
<h3><a class="toc-backref" href="#id8">Setting up Plone site for uploading Sphinx documentation</a><a class="headerlink" href="#setting-up-plone-site-for-uploading-sphinx-documentation" title="Permalink to this headline">¶</a></h3>
<p>First install the <em>Plone Help Center</em> add-on and create a <em>Reference Manual</em>
item at the remote site.</p>
<p>The documentation can be uploaded to:</p>
<ul class="simple">
<li>any Plone site</li>
<li>with <a class="reference external" href="http://plone.org/products/plonehelpcenter">Plone Help Center add-on</a> installed.</li>
<li>Sphinx-specific CSS styles can be installed (optional) for source code colorization,
warnings, notes and other mark-up in the documentation. These are included
as <tt class="docutils literal"><span class="pre">sphinx.css</span></tt> and it is easiest to drop them to your <tt class="docutils literal"><span class="pre">portal_skins</span></tt> layer manually.</li>
</ul>
</div>
<div class="section" id="compiling-html-manual">
<h3><a class="toc-backref" href="#id9">Compiling HTML manual</a><a class="headerlink" href="#compiling-html-manual" title="Permalink to this headline">¶</a></h3>
<p>Use the Sphinx makefile:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">make html</span>
</pre></div>
</div>
</div>
<div class="section" id="running-upload">
<h3><a class="toc-backref" href="#id10">Running upload</a><a class="headerlink" href="#running-upload" title="Permalink to this headline">¶</a></h3>
<p>Buildout generates the <tt class="docutils literal"><span class="pre">bin/toplone</span></tt> command-line script.</p>
<p>Example how to upload to a local Plone instance:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">make clean html</span>
<span class="go">bin/toplone bin/toplone --ploneupload:target=http://admin:admin@localhost:8080/Plone/documentation/manual/plone-community-developer-documentation</span>
</pre></div>
</div>
<p>... or in the case of Plone.org:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">bin/toplone --ploneupload:target=http://username:password@manage.plone.org/documentation/manual/plone-community-developer-documentation</span>
</pre></div>
</div>
<p>(Substitute your username and password in the URL.)</p>
<p>The upload script</p>
<ul class="simple">
<li>is generated when you run buildout (see <tt class="docutils literal"><span class="pre">buildout.cfg</span></tt>);</li>
<li>reconfigures the transmogrifier pipeline to use the remote site and <em>HTTP Basic Auth</em> credentials
provided on the command line;</li>
<li>crawl the Sphinx documentation and extract the title, description and body text of each page
(In theory you could crawl any remote web site for this. The <tt class="docutils literal"><span class="pre">toplone</span></tt> script is
created to crawl local documentation only.);</li>
<li>create <em>Plone Help Center</em> content items at the remote Plone instance using Zope's XML-RPC;</li>
<li>update remote Plone items to reflect documentation changes, using Zope's XML-RPC;</li>
<li>Publish items, and hide unnecessary items from the navigation (e.g. image source folders).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The upload script does not currently purge the existing uploaded documentation.
If pages have been renamed or moved, you need to delete the documentation
on the target site before performing the upload. Just go to the
<em>Reference Manual Contents</em> tab, select all, and hit delete.</p>
</div>
</div>
<div class="section" id="setting-up-css">
<h3><a class="toc-backref" href="#id11">Setting up CSS</a><a class="headerlink" href="#setting-up-css" title="Permalink to this headline">¶</a></h3>
<p>An example <tt class="docutils literal"><span class="pre">sphinx.css</span></tt> is provided with <tt class="docutils literal"><span class="pre">collective.developermanual</span></tt>.</p>
<ul class="simple">
<li>It sets up CSS for default Sphinx styles (notices, warning, other admonition).</li>
<li>It sets up CSS for syntax highlighting.</li>
<li>It resolves some CSS class conflicts between Sphinx and the plone.org theme.</li>
</ul>
<p><tt class="docutils literal"><span class="pre">sphinx.css</span></tt> assumes that a special Sphinx <tt class="docutils literal"><span class="pre">page.html</span></tt> template is used.
This template is modified to wrap everything which Sphinx outputs in the <tt class="docutils literal"><span class="pre">sphinx-content</span></tt>
CSS class, so we can nicely separate them from standard Plone styles.</p>
<p><tt class="docutils literal"><span class="pre">page.html</span></tt> can be found at <tt class="docutils literal"><span class="pre">sources/_templates/page.html</span></tt>.</p>
</div>
</div>
</div>

  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<p class="logo"><a href="../index.html"><img src="../_static/plone-icon-64.png" />
</a></p>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">How to upload Plone community developer documentation to Plone CMS</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#collective-developermanual">collective.developermanual</a></li>
<li><a class="reference internal" href="#setting-up-software-for-manual-compilation-and-upload">Setting up software for manual compilation and upload</a></li>
<li><a class="reference internal" href="#building-static-html-with-sphinx">Building static HTML with Sphinx</a></li>
<li><a class="reference internal" href="#uploading-documentation-to-a-site">Uploading documentation to a site</a><ul>
<li><a class="reference internal" href="#setting-up-plone-site-for-uploading-sphinx-documentation">Setting up Plone site for uploading Sphinx documentation</a></li>
<li><a class="reference internal" href="#compiling-html-manual">Compiling HTML manual</a></li>
<li><a class="reference internal" href="#running-upload">Running upload</a></li>
<li><a class="reference internal" href="#setting-up-css">Setting up CSS</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="writing.html"
                        title="previous chapter">Writing and updating this document</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../tutorials/index.html"
                        title="next chapter">Tutorials</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/introduction/developermanual.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../tutorials/index.html" title="Tutorials"
             >next</a> |</li>
        <li class="right" >
          <a href="writing.html" title="Writing and updating this document"
             >previous</a> |</li>
        <li><a href="../index.html">Plone Community Managed Developer Manual v1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Introduction</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010 mFabrik Research Oy and Plone community contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>


  </body>
</html>